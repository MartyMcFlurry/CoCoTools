

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Pre-Processing Query Results &mdash; CoCoTools 0.0.1 documentation</title>
    
    <link rel="stylesheet" href="_static/sphinxdoc.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '',
        VERSION:     '0.0.1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="top" title="CoCoTools 0.0.1 documentation" href="index.html" />
    <link rel="up" title="Processing Pipeline in Detail" href="details.html" />
    <link rel="next" title="Applying Coordinate-Free Registration" href="coordinatefreereg.html" />
    <link rel="prev" title="Querying" href="querying.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="coordinatefreereg.html" title="Applying Coordinate-Free Registration"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="querying.html" title="Querying"
             accesskey="P">previous</a> |</li>
        <li><a href="index.html">CoCoTools 0.0.1 documentation</a> &raquo;</li>
          <li><a href="documentation.html" >CoCoTools&#8217;s documentation</a> &raquo;</li>
          <li><a href="details.html" accesskey="U">Processing Pipeline in Detail</a> &raquo;</li> 
      </ul>
    </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Pre-Processing Query Results</a><ul>
<li><a class="reference internal" href="#do-you-need-to-pre-process">Do you need to Pre-Process?</a></li>
<li><a class="reference internal" href="#pre-processing-steps">Pre-Processing Steps</a></li>
<li><a class="reference internal" href="#example">Example</a></li>
<li><a class="reference internal" href="#module-cocotools">Doc strings</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="querying.html"
                        title="previous chapter">Querying</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="coordinatefreereg.html"
                        title="next chapter">Applying Coordinate-Free Registration</a></p>
  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="_sources/preprocessing.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="pre-processing-query-results">
<h1>Pre-Processing Query Results<a class="headerlink" href="#pre-processing-query-results" title="Permalink to this headline">¶</a></h1>
<div class="section" id="do-you-need-to-pre-process">
<span id="detail-preproc"></span><h2>Do you need to Pre-Process?<a class="headerlink" href="#do-you-need-to-pre-process" title="Permalink to this headline">¶</a></h2>
<p>For users just interested in interrogating query results from a specific study or set of studies, the MapGraph and ConGraphs derived from querying is all that you may need.</p>
<p>However, most most users&#8217; ultimate goal with CoCoTools will be to agregate connectivity results from several studies into a single connectivity matrix.
In this case, the mapping and connectivity data that was gathered during the query step, will serve as input to CoCoTools&#8217; coordinate-free registration machinery.</p>
<p>For the best registration outcomes, users will need to <em>pre-process</em> this mapping and connectivity input data.</p>
</div>
<div class="section" id="pre-processing-steps">
<h2>Pre-Processing Steps<a class="headerlink" href="#pre-processing-steps" title="Permalink to this headline">¶</a></h2>
<p>Pre-Processing is performed in three steps in CoCoTools</p>
<blockquote>
<div><ol class="arabic">
<li><p class="first">Clean the mapping data of various ommisions and errors using:</p>
<blockquote>
<div><dl class="function">
<dt id="clean_data">
<tt class="descname">clean_data</tt><big>(</big><em>mapgraph</em><big>)</big><a class="headerlink" href="#clean_data" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</div></blockquote>
<p>This function only fixes the issues that we have identified. This function adds and removes specific edges from the mapgraph. <em>To see the list of edges, and our comments, view the mapgraph.py</em></p>
</li>
<li><p class="first">Remove hierarchies and instate only one level of resolution in the target space (the space you want your data registered to) using:</p>
<blockquote>
<div><dl class="function">
<dt id="keep_only_one_level_of_resolution">
<tt class="descname">keep_only_one_level_of_resolution</tt><big>(</big><em>congraph</em>, <em>targetmap</em><big>)</big><a class="headerlink" href="#keep_only_one_level_of_resolution" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p>The coordinate-free registration algorithms that we have implemented require that the target data is represented at one resolution and that all regions within the target map are mutually disjoint (lest the algorithm crashes or produce errors). This is not the case for many studies in CoCoMac.
To resolve this problem, this function:</p>
<blockquote>
<div><ul class="simple">
<li>builds a hierarchy for each map based on its spatial relationships</li>
<li>and removes from each map all but one level of resolution ? ensuring that the areas kept in the graph are disjoint.</li>
<li>By default, this command keeps the level with the most anatomical connections, and then translates connections from the other levels to the one that is retained.</li>
</ul>
</div></blockquote>
</div></blockquote>
</li>
<li><p class="first">Only a fraction of all possible mapping relationships have been explicitly stated in the literature and recorded in CoCoMac. However, a very large set of new mapping relationships can be logically deduced using these mapping relationships.
This process is explained by Stephan et al. (2000). After making the insight that spatial relationships between areas can be represented as a mathematical graph (as in the MapGraph), Stephan et al. (2000) applied a classic technique from graph theory, Floyd?s algorithm (Floyd, 1962), to infer chains of relationships among brain areas. Depending on the relationships in each chain, they can be used to deduce a single RC between the area at the beginning of each chain and the one at the end.
CoCoTools implements this procedure (and updates from K?tter &amp; Wanke, 2005) with the:</p>
<blockquote>
<div><dl class="function">
<dt id="deduce_edges">
<tt class="descname">deduce_edges</tt><big>(</big><em>mapgraph</em><big>)</big><a class="headerlink" href="#deduce_edges" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</div></blockquote>
<p>Chains of relationships can be reduced to single RCs with variable levels of ambiguity, but in CoCoTools we allow new relationships to be added to the graph only in unambiguous cases. When different chains imply a relationship between the same two areas, we keep the RC implied by the chain with the fewest areas.</p>
<dl class="docutils">
<dt>Important::</dt>
<dd><p class="first last">The <strong>deduce_edges</strong> step can take a very long time to run. With the entire CoCoMac corpus, it can take <strong>days</strong> to run on standard laptop computers (as of 2012).   Floyd?s algorithm requires approximately N<sup>3</sup> computations, with N being the number of nodes.
However this step is essential; adding a huge number of unstated mapping relationships (numbering in the hundreds of thousands).
Without these deduced relationships, many translations would be impossible.</p>
</dd>
</dl>
</li>
</ol>
</div></blockquote>
</div>
<div class="section" id="example">
<h2>Example<a class="headerlink" href="#example" title="Permalink to this headline">¶</a></h2>
<p>Here is a quick example of the cocotools commands needed for pre-processing:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">mapg</span><span class="o">.</span><span class="n">clean_data</span><span class="p">()</span>
<span class="n">cong</span><span class="o">=</span><span class="n">mapg</span><span class="o">.</span><span class="n">keep_only_one_level_of_resolution</span><span class="p">(</span><span class="n">cong</span><span class="p">,</span> <span class="s">&#39;PHT00&#39;</span><span class="p">)</span>
<span class="n">mapg</span><span class="o">.</span><span class="n">deduce_edges</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="section" id="module-cocotools">
<span id="doc-strings"></span><h2>Doc strings<a class="headerlink" href="#module-cocotools" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="cocotools.MapGraph">
<em class="property">class </em><tt class="descclassname">cocotools.</tt><tt class="descname">MapGraph</tt><a class="headerlink" href="#cocotools.MapGraph" title="Permalink to this definition">¶</a></dt>
<dd><p>Subclass of the NetworkX DiGraph designed to hold CoCoMac Mapping data.</p>
<p>Each node must be specified in CoCoMac format as a string:
&#8216;BrainMap-BrainSite&#8217;.  Nodes not in this format are rejected.  Node
attributes are not allowed.</p>
<p>Edges have the following attributes (but only RC and PDC should be
supplied by the user):</p>
<p>(1) RC (relation code).  Allowable values are &#8216;I&#8217; (identical to),
&#8216;S&#8217; (smaller than), &#8216;L&#8217; (larger than), or &#8216;O&#8217; (overlaps with).  These
values complete the sentence, The source node is _____ the target node.</p>
<p>(2) TP (transformation path).  This is a list of regions representing
the chain of relationships (the path within the graph) that mediates
the relationship between the source and the target.  When the
relationship between the source and the target has been pulled directly
from the literature, TP is an empty list.  When source&#8217;s relationship
to target is known because of source&#8217;s relationship to region X and
region X&#8217;s relationship to target, TP is [&#8216;X&#8217;].  The list grows with
the number of intervening nodes.  Of note, the TP for the edge from
target to source must be the reverse of the TP for the edge from
source to target.</p>
<p>(3) PDC (precision description code).  An integer (from zero to 18,
with zero being the best) corresponding to an index in the PDC
hierarchy (cocotools.query.PDC_HIER), which was developed by the
CoCoMac curators.  Entries in the hierarchy represent levels of
precision with which a statement in the original literature can be
made.  When the edge is absent from the literature and has been
deduced based on other edges (i.e., when the TP length is greater
than zero), the PDC corresponds to the worst PDC of the edges
represented by TP.</p>
<p>Accurate deduction of new spatial relationships among regions and
accurate translation of connectivity data between maps demand that each
map be represented at just one level of resolution.  This implies that
when a suite of spatially related regions from the same map is
identified, one or more regions must be excluded from the MapGraph
until all remaining are disjoint.</p>
<p>When keep_only_one_level_of_resolution is called, all but one level of
resolution is removed from the graph (and cong).  The level with the
most anatomical connections (i.e., edges in cong) is chosen; in the
event of a tie, the finest level of resolution is chosen for all maps
but the target map, for which the coarsest level of resolution is
chosen.</p>
<p>Redundant nodes within a map are merged into a single node in this
graph and in the associated ConGraph.  A name for the node is chosen
from the list of redundant ones arbitrarily.</p>
<p>New spatial relationships are deduced using an enhanced version of
Objective Relational Transformation (ORT) with the deduce_edges method.
The strategy used in MapGraph for handling intra-map spatial
relationships described above ensures that levels of resolution will
not be mixed within maps when deduce_edges is called.  This allows
deduce_edges to assume all regions within a map are disjoint, which
enables, after all possible deductions have been made, automatic
identification and removal of relationships that cannot be true due to
their implication (in combination with other known relationships) of
spatial overlap between regions in the same map.</p>
</dd></dl>

</div>
</div>


          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="coordinatefreereg.html" title="Applying Coordinate-Free Registration"
             >next</a> |</li>
        <li class="right" >
          <a href="querying.html" title="Querying"
             >previous</a> |</li>
        <li><a href="index.html">CoCoTools 0.0.1 documentation</a> &raquo;</li>
          <li><a href="documentation.html" >CoCoTools&#8217;s documentation</a> &raquo;</li>
          <li><a href="details.html" >Processing Pipeline in Detail</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2011, Daniel Bliss, Rob Blumenfeld and Fernando Perez.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.1.3.
    </div>
  </body>
</html>